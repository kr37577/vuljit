# RQ3 実装計画


## フェーズ1: 要件整理とデータ調査
- [x] `prediction/` 配下の既存機械学習パイプライン（特徴量生成〜推論）の処理フローと成果物を整理する
- [x] RQ1/RQ2で生成した脆弱性ラベルとビルド（fuzzing回数）との対応関係を明示し、参照先ファイル・テーブルを特定する
- [x] プロジェクトごとの脆弱性検出日・追加ビルド日が記録されたソースを洗い出し、欠損や形式を確認する

## フェーズ2: データ整形と指標定義
- [x] 各プロジェクトのビルド履歴を時系列に並べ、ビルド番号とfuzzing実行回数を同じ軸にマッピングするスクリプトを作成する
- [x] 脆弱性検出までの経過日数・ビルド回数を算出し、「発見までの早さ」「無駄ビルド数」の指標定義を数式レベルでドキュメント化する
- [x] 追加ビルド発生タイミングを決定するため、脆弱性ラベル（JITモデル出力）と暫定閾値（Precision目標）を結び付けるための閾値調整手順をまとめる

- [x] 戦略1: プロジェクト別「混入〜検出までの中央値」を算出し、JITモデルで出力した脆弱性ラベルが掲載されている日に対して，「混入〜検出までの中央値」分の追加ビルドを行う
- [x] 戦略2: JITモデルで出力した脆弱性ラベルが掲載されている日に対して，戦略1で得た中央値レンジ内でランダムに追加ビルド時点をサンプリングするシミュレーションコードを実装し、再現性確保のため乱数種を制御する
- [x] 戦略3: 1日あたり変更行数に比例して追加ビルド頻度を調整するモデルを実装し、変更量データのスケーリング・正規化方針を定める．JITモデルで出力した脆弱性ラベルが掲載されている日に対して，追加ビルドを行う．
- [x] 戦略4: クロスプロジェクト線形回帰で追加ビルド発生タイミングを予測するモデルを実装し、学習・検証分割と特徴量セットを定義する，JITモデルで出力した脆弱性ラベルが掲載されている日に対して，追加ビルドを行う．
    - 目的変数を追加ビルド数へdetection_time_days × builds_per_day を基に「検出までに必要だった実ビルド数」「追加で必要だったビルド数」を算出し、それを回帰のターゲットにする。無駄ビルドを特定したいなら、所望精度でのトリガー日から実検出日までの差分ビルド数を目的変数にする。


## フェーズ4: 精度信頼性と閾値分析
- [x] JIT脆弱性予測モデルのPrecision／Recallカーブを算出し、追加ビルドの意思決定に必要なPrecision水準を複数案で検討する
- [x] Precision目標を変化させた場合に各戦略の追加ビルド数・検出スピードがどう変動するか比較する分析スクリプトを整備する
- [x] 低Precision時のリスク（誤検知による無駄ビルド）が評価指標にどう影響するかを可視化するレポート出力を実装する

## フェーズ5: シミュレーションと評価
- [x] 4戦略それぞれについて時系列シミュレーションを回し、プロジェクト単位の「発見までのビルド数」「余分ビルド数」を算出する
- [x] シミュレーション結果を統合し、平均・中央値・分位点などを比較できる集計テーブルと可視化（箱ひげ図等）を生成する
- [x] RQ3の主張に沿って、どの戦略が最速で脆弱性を発見し、かつ無駄ビルドを抑えられるかを定量的に示す指標をまとめる

## フェーズ6: 検証・ドキュメンテーション
- [x] 実装コードに対してユニットテスト／統合テストを追加し、再現性と閾値設定の妥当性を検証する
- [x] シミュレーション結果・分析手順・閾値選定理由を `RQ3` ディレクトリ内ドキュメントに整理する
- [x] 追加ビルド戦略の比較結果とPrecisionに関する考察を最終レポート（RQ3節）に反映する
